{% extends "index.html" %}
{% load static %}
{% block content %}
<main>
    <h1 class="page-title">Il Mio Account</h1>
   
    <div class="container_profilo">
        <div class="barra">
            <div class="info-user">
                <img src="https://thumbs.dreamstime.com/b/icona-utente-social-media-vettoriale-immagine-profilo-avatar-predefinita-potrait-182347582.jpg" alt="Avatar" class="avatar">
                <div>
                    <h2 class="user-name">Simone</h2>
                    <p class="user-email">simone.panichi@gmail.com</p>                
                </div>
            </div>
           
            <ul class="nav-menu">
                <li><a href="#" class="active"><i>üìã</i> I Miei Ordini</a></li>
                <li><a href="#"><i>üè†</i> Indirizzi</a></li>
                <li><a href="#"><i>üë§</i> Dati Personali</a></li>
                <li><a href="#"><i>üì§</i> Logout</a></li>
            </ul>
        </div>
        <div class="content-area">
            <div class="content-header">
                <h2 class="content-title">I Miei Ordini</h2>
                
                <div class="filter-container">
                    <select class="filter-select">
                        <option value="all">Tutti gli ordini</option>
                        <option value="completed">Completati</option>
                        <option value="processing">In elaborazione</option>
                        <option value="canceled">Annullati</option>
                    </select>
                    
                    <input type="text" placeholder="Cerca ordine..." class="search-input">
                </div>
            </div>
            
            <table class="orders-table">
                <thead>
                    <tr>
                        <th>Numero Ordine</th>
                        <th>Data</th>
                        <th>Prodotti</th>
                        <th>Totale</th>
                        <th>Stato</th>
                        <th>Azioni</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-order-id="ORD2025042501">
                        <td>#ORD2025042501</td>
                        <td>25/04/2025</td>
                        <td>3 prodotti</td>
                        <td>‚Ç¨52,40</td>
                        <td><span class="status-badge status-completed">Completato</span></td>
                        <td class="order-actions">
                            <button class="action-btn view-btn" onclick="toggleOrderDetail('ORD2025042501')">Dettagli</button>
                            <button class="action-btn view-btn">Fattura</button>
                        </td>
                    </tr>
                    <tr style="display: none;">
                        <td colspan="6">
                            <div class="order-detail" id="detail-ORD2025042501">
                                <div class="detail-header">
                                    <h3 class="detail-title">Dettagli Ordine #ORD2025042501</h3>
                                    <button class="close-detail" onclick="toggleOrderDetail('ORD2025042501')">√ó</button>
                                </div>
                                
                                <div class="order-items">
                                    <div class="order-item">
                                        <img src="/api/placeholder/60/60" alt="Bibbia Illustrata" class="item-image">
                                        <div class="item-details">
                                            <h4 class="item-name">La Bibbia Illustrata - Edizione Speciale</h4>
                                            <div class="item-meta">
                                                <span>Quantit√†: 1</span>
                                                <span>ISBN: 978-8821598746</span>
                                            </div>
                                        </div>
                                        <div class="item-price">‚Ç¨39,90</div>
                                    </div>
                                    
                                    <div class="order-item">
                                        <img src="/api/placeholder/60/60" alt="Segnalibro" class="item-image">
                                        <div class="item-details">
                                            <h4 class="item-name">Segnalibro in Argento - Angelo Custode</h4>
                                            <div class="item-meta">
                                                <span>Quantit√†: 1</span>
                                                <span>Cod: SL-ANG-01</span>
                                            </div>
                                        </div>
                                        <div class="item-price">‚Ç¨12,50</div>
                                    </div>
                                </div>
                                
                                <div class="order-summary">
                                    <div class="summary-row">
                                        <span>Subtotale:</span>
                                        <span>‚Ç¨52,40</span>
                                    </div>
                                    <div class="summary-row">
                                        <span>Spedizione:</span>
                                        <span>‚Ç¨0,00 (Gratuita)</span>
                                    </div>
                                    <div class="summary-row total">
                                        <span>Totale:</span>
                                        <span>‚Ç¨52,40</span>
                                    </div>
                                </div>
                                
                                <div class="address-info">
                                    <div class="address-box">
                                        <h4 class="address-title">Indirizzo di Spedizione</h4>
                                        <p>Marco Bianchi<br>
                                           Via Roma 123<br>
                                           20100, Milano (MI)<br>
                                           Italia<br>
                                           Tel: 333 1234567</p>
                                    </div>
                                    
                                    <div class="address-box">
                                        <h4 class="address-title">Metodo di Pagamento</h4>
                                        <p>Carta di Credito<br>
                                           **** **** **** 4589<br>
                                           Scadenza: 05/2026</p>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    
                    <tr data-order-id="ORD2025031802">
                        <td>#ORD2025031802</td>
                        <td>18/03/2025</td>
                        <td>1 prodotto</td>
                        <td>‚Ç¨24,50</td>
                        <td><span class="status-badge status-completed">Completato</span></td>
                        <td class="order-actions">
                            <button class="action-btn view-btn" onclick="toggleOrderDetail('ORD2025031802')">Dettagli</button>
                            <button class="action-btn view-btn">Fattura</button>
                        </td>
                    </tr>
                    <tr style="display: none;">
                        <td colspan="6">
                            <div class="order-detail" id="detail-ORD2025031802">
                                <div class="detail-header">
                                    <h3 class="detail-title">Dettagli Ordine #ORD2025031802</h3>
                                    <button class="close-detail" onclick="toggleOrderDetail('ORD2025031802')">√ó</button>
                                </div>
                                
                                <div class="order-items">
                                    <div class="order-item">
                                        <img src="/api/placeholder/60/60" alt="Icona Sacra" class="item-image">
                                        <div class="item-details">
                                            <h4 class="item-name">Icona Sacra Famiglia</h4>
                                            <div class="item-meta">
                                                <span>Quantit√†: 1</span>
                                                <span>Cod: IC-SACFAM-02</span>
                                            </div>
                                        </div>
                                        <div class="item-price">‚Ç¨24,50</div>
                                    </div>
                                </div>
                                
                                <div class="order-summary">
                                    <div class="summary-row">
                                        <span>Subtotale:</span>
                                        <span>‚Ç¨24,50</span>
                                    </div>
                                    <div class="summary-row">
                                        <span>Spedizione:</span>
                                        <span>‚Ç¨0,00 (Gratuita)</span>
                                    </div>
                                    <div class="summary-row total">
                                        <span>Totale:</span>
                                        <span>‚Ç¨24,50</span>
                                    </div>
                                </div>
                                
                                <div class="address-info">
                                    <div class="address-box">
                                        <h4 class="address-title">Indirizzo di Spedizione</h4>
                                        <p>Marco Bianchi<br>
                                           Via Roma 123<br>
                                           20100, Milano (MI)<br>
                                           Italia<br>
                                           Tel: 333 1234567</p>
                                    </div>
                                    
                                    <div class="address-box">
                                        <h4 class="address-title">Metodo di Pagamento</h4>
                                        <p>PayPal<br>
                                           marco.bianchi@esempio.it</p>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    
                    <tr data-order-id="ORD2025021503">
                        <td>#ORD2025021503</td>
                        <td>15/02/2025</td>
                        <td>2 prodotti</td>
                        <td>‚Ç¨31,40</td>
                        <td><span class="status-badge status-processing">In elaborazione</span></td>
                        <td class="order-actions">
                            <button class="action-btn view-btn" onclick="toggleOrderDetail('ORD2025021503')">Dettagli</button>
                            <button class="action-btn track-btn">Traccia</button>
                        </td>
                    </tr>
                    <tr style="display: none;">
                        <td colspan="6">
                            <div class="order-detail" id="detail-ORD2025021503">
                                <div class="detail-header">
                                    <h3 class="detail-title">Dettagli Ordine #ORD2025021503</h3>
                                    <button class="close-detail" onclick="toggleOrderDetail('ORD2025021503')">√ó</button>
                                </div>
                                
                                <div class="order-items">
                                    <div class="order-item">
                                        <img src="/api/placeholder/60/60" alt="Vangelo" class="item-image">
                                        <div class="item-details">
                                            <h4 class="item-name">Vangelo Tascabile</h4>
                                            <div class="item-meta">
                                                <span>Quantit√†: 1</span>
                                                <span>ISBN: 978-8821598123</span>
                                            </div>
                                        </div>
                                        <div class="item-price">‚Ç¨12,50</div>
                                    </div>
                                    
                                    <div class="order-item">
                                        <img src="/api/placeholder/60/60" alt="Rosario" class="item-image">
                                        <div class="item-details">
                                            <h4 class="item-name">Rosario in Legno d'Ulivo</h4>
                                            <div class="item-meta">
                                                <span>Quantit√†: 1</span>
                                                <span>Cod: ROS-ULI-01</span>
                                            </div>
                                        </div>
                                        <div class="item-price">‚Ç¨18,90</div>
                                    </div>
                                </div>
                                
                                <div class="order-summary">
                                    <div class="summary-row">
                                        <span>Subtotale:</span>
                                        <span>‚Ç¨31,40</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>  
            </table>
        </div>
    </div>  
    
</main>
<script>
   // Script per la gestione degli ordini
document.addEventListener('DOMContentLoaded', function() {
    // Nascondi tutti i dettagli all'inizio
    document.querySelectorAll('.order-detail').forEach(detail => {
        const detailRow = detail.closest('tr');
        if (detailRow) {
            detailRow.style.display = 'none';
        }
    });
    
    // Gestisci filtri
    setupFilters();
});

/**
 * Toggle visibilit√† dettagli ordine
 */
function toggleOrderDetail(orderId) {
    // Ottieni la riga dell'ordine
    const orderRow = document.querySelector(`tr[data-order-id="${orderId}"]`);
    if (!orderRow) return;
    
    // Ottieni la riga dei dettagli (quella successiva)
    const detailRow = orderRow.nextElementSibling;
    if (!detailRow || !detailRow.querySelector(`#detail-${orderId}`)) return;
    
    // Alterna la visibilit√†
    const isVisible = detailRow.style.display === 'table-row';
    
    // Prima chiudi tutti i dettagli
    document.querySelectorAll('.order-detail').forEach(detail => {
        const row = detail.closest('tr');
        if (row) {
            row.style.display = 'none';
        }
        detail.classList.remove('active');
    });
    
    // Se era nascosto, mostralo
    if (!isVisible) {
        detailRow.style.display = 'table-row';
        const detailElement = document.getElementById(`detail-${orderId}`);
        if (detailElement) {
            detailElement.classList.add('active');
        }
    }
}

/**
 * Configura i filtri per la tabella degli ordini
 */
function setupFilters() {
    const filterSelect = document.querySelector('.filter-select');
    const searchInput = document.querySelector('.search-input');
    const orderRows = document.querySelectorAll('.orders-table tbody tr[data-order-id]');
    
    if (filterSelect) {
        filterSelect.addEventListener('change', () => filterOrders(orderRows, filterSelect, searchInput));
    }
    
    if (searchInput) {
        searchInput.addEventListener('input', () => filterOrders(orderRows, filterSelect, searchInput));
    }
}

/**
 * Filtra le righe della tabella in base ai criteri
 */
function filterOrders(orderRows, filterSelect, searchInput) {
    const filterValue = filterSelect ? filterSelect.value : 'all';
    const searchValue = searchInput ? searchInput.value.toLowerCase() : '';
    
    // Nascondi tutti i dettagli prima
    document.querySelectorAll('.order-detail').forEach(detail => {
        const row = detail.closest('tr');
        if (row) {
            row.style.display = 'none';
        }
        detail.classList.remove('active');
    });
    
    // Applica i filtri alle righe degli ordini
    orderRows.forEach(row => {
        let showRow = true;
        
        // Filtra per stato
        if (filterValue !== 'all') {
            const statusElement = row.querySelector('.status-badge');
            if (statusElement) {
                const hasStatus = statusElement.classList.contains('status-' + filterValue);
                if (!hasStatus) {
                    showRow = false;
                }
            }
        }
        
        // Filtra per testo di ricerca
        if (searchValue !== '') {
            const rowText = row.textContent.toLowerCase();
            if (!rowText.includes(searchValue)) {
                showRow = false;
            }
        }
        
        // Mostra o nascondi la riga
        row.style.display = showRow ? '' : 'none';
    });
}
</script>
{% endblock content %}